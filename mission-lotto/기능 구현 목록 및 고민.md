## API

1. 사용자 등록시 이름과 소유 금액을 함께 저장하는 기능.
   * endPoint : [POST, /create]
   * 설명 : 이름, 소유 금액 저장
   * Exception : 없음
   * request :
     {
     "name": "juna",
     "money": 5000
     }
   * response : 없음
   
* 작성 방식
  * 사용자마다 id(기본키)를 가지게 하였음 => 동명이인 방지
  * 기본키 identity 전략을 사용.

2. 로또를 n장 구매하는 기능. (로또 추가 구매 기능 포함.) - 이때 로또 당첨 번호도 같이 생성 후 비교.
   * endPoint : [POST, /buy]
   * 설명 : 로또 구매, 구매 시점에 랜덤으로 번호 발급, 로또 당첨 번호도 같이 생성 및 저장(저장 시 당첨 여부 계산)
   * Exception : 돈 보다 많은 로또 구매할 경우, 
   * request :
     {
     "userId": 1,
     "count": 3
     }
   * response : 없음

* 작성 방식
    * 구매할 때 userId 값을 명시하여서 어떤 유저가 몇 장 샀는지 저장 가능하게 하였음.
    * 로또 당첨 번호도 같이 생성해준 이유는, 도메인에 로또 당첨 번호 생성해서 비교하는 메서드 구현하면 너무 복잡해질 것 같아서 로또 당첨 번호 엔티티와 메서드를 따로 만들었음.
    * 로또 번호를 생성하는 동시에 당첨 번호도 같이 생성하여 비교하게 하였음 => 당첨 여부, 유저 당첨 금액 같이 update

3. 특정 사용자가 지금까지 뽑은 모든 로또의 번호와 당첨 여부를 함께 확인하는 기능.
    * endPoint : [GET, /user/{id}/lottos] @PathVariable
    * 설명 : 특정 사용자 로또 정보 조회
    * Exception : 로또 사지 않았는데 조회할 경우.
    * request : x 
    * response :
      [
      {
      "lottoNumber": "[32, 20, 45, 30, 19, 7]",
      "win": false
      },
      {
      "lottoNumber": "[4, 31, 18, 29, 27, 13]",
      "win": false
      }
      ]
   
* 작성 방식
  * LottoRepository에 List<LottoEntity-> findAllByUserId(Long userId); 메서드 만들어서 로또 엔티티 다 가져올 수 있게 구현.
  * 가져온 데이터를 LottoResponse에 담아 컨트롤러에 전달하는 방식
  * 당첨 여부라 하였으니, boolean 값으로 받았음.

4. 특정 사용자가 지금까지 뽑은 특정 로또의 번호와 당첨 여부를 확인하는 기능.
    * endPoint : [GET, /user/{id}/lottos?order=1] @PathVariable, @RequestParam
    * 설명 : 특정 사용자의 특정 로또 정보 조회
    * Exception : 로또 사지 않았는데 조회할 경우, 3개 샀는데 4번 째 로또 고르는 경우
    * request : x
    * response :
      {
      "lottoNumber": "[32, 20, 45, 30, 19, 7]",
      "win": false
      }
   
* 작성 방식
  * API 3번(특정 사용자 모든 로또 조회) 메서드 재활용.
  * @PathVariable 로 특정 사용자 조회 후, @RequestParam 으로 몇 번째 로또 받을 것인지 구현.

5. 모든 사용자의 구매 로또 개수와 당첨 금액을 확인하는 기능.
   * endPoint : [GET, /users] 
   * 설명 : 모든 사용자의 로또, 당첨 금액 조회.
   * Exception : 유저 없을 경우.
   * request : x
   * response :
     [
     {
     "name": "juna",
     "lottoTicket": 2,
     "winning": 0
     }
     ]

* 작성 방식
  * findAll() 메서드 사용하여 모든 유저 끌어옴

---
## 고민

### Controller
* API 2번의 경우, 로또를 사면서 User Money를 업데이트 해주게 되는데 이때 PATCH 메서드를 사용하는 것이 옳다고 생각하는데 또 로또는 새로 생성하기에 POST로 한꺼번에 받아서 수정하였음. 이게 맞는지 잘 모르겠음.(순위 저장하는 API도 마찬가지).

### Entity
* 일단 User 테이블 만들어서 name, money 저장할 수 있게 하고, User_id 참조키로 해서 Lotto_Ticket 데베 하나 생성하는 방식으로 가야할듯
* 특정 사용자 조회할 때는, 동명이인 있을 수도 있으니 id 값으로 조회 가능하도록 구현해야 할듯
* 로또 번호 list로 저장 불가능해서 String 으로 저장해야할 것 같음.
* 로또 당첨 번호 위해서 따로 entity 파야할 듯.

### Service
* @Transaction 공부 필요

### 이론
* service끼리 참조하는 것 왜 오류 날까(아무 조치 취하지 않았을 때)
* dto에 toEntity 같은 메서드 구현해도 되나?
* Entity가 기본생성자를 왜 가져야할까(꺼내올 때), 왜 @NoArgsConstructor 썼는데 오류?? - 공부 필요


---
## 도메인 구현

* 숫자 하나 하나 원시값 포장 - Number
* 숫자 묶음 - Lotto
* ~~로또 묶음 - Lottos~~ ==> 필요 없을 것 같음
* 예외처리 - exception 패키지
* 랜덤 숫자 발생 - interface : CreateRandomNumber , 구현체 : LottoRandomNumber
* 로또 가격 - LottoPrice(enum)
* 로또 순위(맞은 개수) - LottoRank : 데베에서 두 리스트 받아와서 맞은 개수 반환하도록 구현
* String 형 LottoNumber 변환 클래스 - LottoNumberParser
---
## 웹 구현

### Service

* UserService : 유저 생성, 조회 같은 기능만.
* LottoService : Lotto 에 관한 모든 기능.

### Controller

* UserController : 유저에 관한 기능.
* LottoController : 로또에 관한 기능

### Entity

* User : 금액, 이름, 로또 몇 개 샀는지
* LottoEntity : 로또에 관한 모든 것. @ManyToOne 사용 - userId , lottoNumber
* LottoAnswer : lottoNumber
